<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `View` struct in crate `region`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, View">

    <title>region::View - Rust</title>

    <link rel="stylesheet" type="text/css" href="../normalize.css">
    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">
    

    
    
</head>
<body class="rustdoc struct">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'>Struct View</p><div class="block items"><ul><li><a href="#methods">Methods</a></li></ul></div><p class='location'><a href='index.html'>region</a></p><script>window.sidebarCurrent = {name: 'View', ty: 'struct', relpath: ''};</script><script defer src="sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content">
<h1 class='fqn'><span class='in-band'>Struct <a href='index.html'>region</a>::<wbr><a class="struct" href=''>View</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a class='srclink' href='../src/region/view.rs.html#79-81' title='goto source code'>[src]</a></span></h1>
<pre class='rust struct'>pub struct View { /* fields omitted */ }</pre><div class='docblock'><p>A view aligned to page boundaries.</p>

<p>This view is not aligned to regions, but uses the same granularity as the
OSs page size. Therefore it is useful when changing protection, only
affecting the pages within the view (instead of entire regions).</p>

<p>Beyond this, it also preserves the previous and initial protection state of
all pages within the view. This allows for easily changing states while,
still being able to restore them at a later stage.</p>

<h1 id='implementation' class='section-header'><a href='#implementation'>Implementation</a></h1>
<p>Consider the following 6 pages in memory:</p>

<pre><code class="language-c">0      4096     8192     12288    16384    20480    24576
+--------+--------+--------+--------+--------+--------+
|  4096  |  4096  |  4096  |  4096  |  4096  |  4096  |
|   RW   |   RX   |   RX   |   RX   |   RX   |   RW   |
+--------+--------+--------+--------+--------+--------+
         |    Region (RX), size of 16 384    |
         +--------+-----------------+--------+
                  | View (len 8192) |
                  +-----------------+
</code></pre>

<p>If the view is created with the values:</p>

<ul>
<li><code>address = 8500</code> (rounded down to the closest page boundary).</li>
<li><code>size = 4000</code> (rounded up to the closest page boundary, relative to the
address).</li>
</ul>

<p>It will contain all pages within the range <code>[8192, 16384)</code>, and have a
<code>len()</code> of <code>8192</code>, ignoring the boundaries of the intersecting region.</p>

<h1 id='examples' class='section-header'><a href='#examples'>Examples</a></h1>
<pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">region</span>::{<span class="ident">View</span>, <span class="ident">Protection</span>};

<span class="kw">let</span> <span class="ident">ret5</span> <span class="op">=</span> [<span class="number">0xB8</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC3</span>];
<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">view</span> <span class="op">=</span> <span class="ident">View</span>::<span class="ident">new</span>(<span class="ident">ret5</span>.<span class="ident">as_ptr</span>(), <span class="ident">ret5</span>.<span class="ident">len</span>()).<span class="ident">unwrap</span>();

<span class="kw">unsafe</span> {
  <span class="ident">view</span>.<span class="ident">exec_with_prot</span>(<span class="ident">Protection</span>::<span class="ident">ReadWriteExecute</span>, <span class="op">||</span> {
    <span class="kw">let</span> <span class="ident">x</span>: <span class="kw">extern</span> <span class="string">&quot;C&quot;</span> <span class="kw">fn</span>() <span class="op">-&gt;</span> <span class="ident">i32</span> <span class="op">=</span> <span class="kw">unsafe</span> { <span class="ident">std</span>::<span class="ident">mem</span>::<span class="ident">transmute</span>(<span class="ident">ret5</span>.<span class="ident">as_ptr</span>()) };
    <span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">x</span>(), <span class="number">5</span>);
  }).<span class="ident">unwrap</span>()
}</pre>
</div><h2 id='methods'>Methods</h2><h3 class='impl'><span class='in-band'><code>impl <a class="struct" href="../region/struct.View.html" title="struct region::View">View</a></code></span><span class='out-of-band'><div class='ghost'></div><a class='srclink' href='../src/region/view.rs.html#83-221' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.new' class="method"><span id='new.v' class='invisible'><code>fn <a href='#method.new' class='fnname'>new</a>(address: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*const </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="type" href="../region/error/type.Result.html" title="type region::error::Result">Result</a>&lt;Self&gt;</code></span></h4>
<div class='docblock'><p>Constructs a new page view.</p>

<p>The constructor uses <code>query_range</code> internally.</p>

<ul>
<li>The address is aligned to the closest page boundary.</li>
<li>The upper bound (<code>address + size</code>) is rounded up to the closest page
boundary.</li>
</ul>
</div><h4 id='method.get_prot' class="method"><span id='get_prot.v' class='invisible'><code>fn <a href='#method.get_prot' class='fnname'>get_prot</a>(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../region/Protection/struct.Flag.html" title="struct region::Protection::Flag">Flag</a>&gt;</code></span></h4>
<div class='docblock'><p>Returns the protection of the pages within the view.</p>

<p>This will only return the protection if all containing pages have the
same protection, otherwise <code>None</code> will be returned.</p>
</div><h4 id='method.set_prot' class="method"><span id='set_prot.v' class='invisible'><code>unsafe fn <a href='#method.set_prot' class='fnname'>set_prot</a>(&amp;mut self, access: <a class="enum" href="../region/enum.Access.html" title="enum region::Access">Access</a>) -&gt; <a class="type" href="../region/error/type.Result.html" title="type region::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">()</a>&gt;</code></span></h4>
<div class='docblock'><p>Sets the protection of all pages within the view.</p>

<p>Besides applying a new protection state to all pages within the view,
this function can also reset the protection of all pages to their
initial state (<code>Access::Initial</code>) or their previous state
(<code>Access::Previous</code>).</p>

<p>If an access value besides <code>Access::Type</code> is used, it may result in
multiple OS calls depending on the number of pages.</p>
</div><h4 id='method.exec_with_prot' class="method"><span id='exec_with_prot.v' class='invisible'><code>unsafe fn <a href='#method.exec_with_prot' class='fnname'>exec_with_prot</a>&lt;T:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/trait.FnOnce.html" title="trait core::ops::FnOnce">FnOnce</a>()&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;prot: <a class="struct" href="../region/Protection/struct.Flag.html" title="struct region::Protection::Flag">Flag</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;callback: T<br>) -&gt; <a class="type" href="../region/error/type.Result.html" title="type region::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">()</a>&gt;</code></span></h4>
<div class='docblock'><p>Executes a closure while temporarily changing protection state.</p>

<p>This is a comfortable shorthand method, functionally equivalent to
calling <code>set_prot(prot.into())</code>, executing arbitrary code, followed by
<code>set_prot(Access::Previous)</code>.</p>
</div><h4 id='method.lock' class="method"><span id='lock.v' class='invisible'><code>fn <a href='#method.lock' class='fnname'>lock</a>(&amp;mut self) -&gt; <a class="type" href="../region/error/type.Result.html" title="type region::error::Result">Result</a>&lt;<a class="struct" href="../region/struct.LockGuard.html" title="struct region::LockGuard">LockGuard</a>&gt;</code></span></h4>
<div class='docblock'><p>Locks all memory pages within the view.</p>

<p>The view itself does not do any bookkeeping related to whether the pages
are locked or not (since the state can change from outside the library).</p>
</div><h4 id='method.ptr' class="method"><span id='ptr.v' class='invisible'><code>fn <a href='#method.ptr' class='fnname'>ptr</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*const </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a></code></span></h4>
<div class='docblock'><p>Returns the view&#39;s base address.</p>
</div><h4 id='method.mut_ptr' class="method"><span id='mut_ptr.v' class='invisible'><code>fn <a href='#method.mut_ptr' class='fnname'>mut_ptr</a>(&amp;mut self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a></code></span></h4>
<div class='docblock'><p>Returns the view&#39;s base address as mutable</p>
</div><h4 id='method.lower' class="method"><span id='lower.v' class='invisible'><code>fn <a href='#method.lower' class='fnname'>lower</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code></span></h4>
<div class='docblock'><p>Returns the view&#39;s lower bound.</p>
</div><h4 id='method.upper' class="method"><span id='upper.v' class='invisible'><code>fn <a href='#method.upper' class='fnname'>upper</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code></span></h4>
<div class='docblock'><p>Returns the view&#39;s upper bound.</p>
</div><h4 id='method.len' class="method"><span id='len.v' class='invisible'><code>fn <a href='#method.len' class='fnname'>len</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code></span></h4>
<div class='docblock'><p>Returns the length of the view</p>
</div></div></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt>+</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "region";
    </script>
    <script src="../main.js"></script>
    <script defer src="../search-index.js"></script>
</body>
</html>